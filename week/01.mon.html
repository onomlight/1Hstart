<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>월요일 일정</title>
  </head>
  <body>
    <button onclick="checkPassword()">수정하기</button>
    <button id="saveButton" style="display: none">저장하기</button>
      
    </button>
    <table border="1" contenteditable="false">
      <tr>
        <td>*1:10</td>
        <td>
          채은, 대주, 대양, 아인, 예원, 이수, 소율, 나엘, 보경, 지아, 다인,
          제인, 수아
        </td>
      </tr>
      <tr>
        <td>1:45</td>
        <td>시율, 지우, 김준우, 허준우</td>
      </tr>
      <tr>
        <td>2:00</td>
        <td>서연, 주안</td>
      </tr>
      <tr>
        <td>2:10</td>
        <td>->이수, 제인, 나엘, 수아</td>
      </tr>
      <tr>
        <td>2:35</td>
        <td>(칠초 돌봄) 서영채, 민, 시현, 시온</td>
      </tr>
      <tr>
        <td>2:45</td>
        <td>-> 준우, 지우</td>
      </tr>
      <tr>
        <td>3:30</td>
        <td>(교동돌봄) 박채은, 김시율</td>
      </tr>
      <tr>
        <td>3:35</td>
        <td>칠초 서영채</td>
      </tr>
      <tr>
        <td>3:40</td>
        <td>(새솔) 하윤, 한솔, 윤이나</td>
      </tr>
      <tr>
        <td>3:45</td>
        <td>->영채, 시온, 민</td>
      </tr>
      <tr>
        <td>4:00</td>
        <td>(칠초돌봄)김찬호</td>
      </tr>
    </table>
    <script>
     document.addEventListener("DOMContentLoaded", function () {
  const repoOwner = "onomlight";
  const repoName = "1Hstart";

  // 비밀번호 입력 후 수정 가능하게 하는 함수
  function checkPassword() {
    const password = prompt("암호를 입력하세요:");
    if (password === "1234") {
      document.querySelector("table").contentEditable = true;
      document.getElementById("saveButton").style.display = "inline"; // 저장 버튼 보이기
    } else {
      alert("암호가 틀렸습니다.");
    }
  }

  // GitHub Actions를 트리거하는 함수
  async function triggerWorkflow() {
    const content = document.documentElement.outerHTML; // 페이지 전체 HTML 내용 가져오기
    const encodedContent = btoa(unescape(encodeURIComponent(content))); // 내용 인코딩

    try {
      // GitHub API를 사용해 워크플로우 실행
      const response = await fetch(
        `https://api.github.com/repos/${repoOwner}/${repoName}/actions/workflows/update-file.yml/dispatches`,
        {
          method: "POST",
          headers: {
            Authorization: `token ${process.env.REPO_TOKEN}`, // GitHub Secrets에서 토큰 가져오기
            Accept: "application/vnd.github.v3+json",
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            ref: "main", // 브랜치 이름
            inputs: {
              content: encodedContent, // 수정된 내용 전달
            },
          }),
        }
      );

      if (response.ok) {
        alert("GitHub Actions가 성공적으로 실행되었습니다!");
      } else {
        const errorData = await response.json();
        console.error("워크플로우 실행 실패:", errorData);
        alert("워크플로우 실행 실패! 콘솔에서 오류를 확인하세요.");
      }
    } catch (error) {
      console.error("오류 발생:", error);
      alert("GitHub Actions 실행 중 오류가 발생했습니다.");
    }
  }

  // 버튼에 이벤트 리스너 추가
  document.querySelector("button[onclick='checkPassword()']").onclick = checkPassword;
  document.getElementById("saveButton").onclick = triggerWorkflow;
});
    </script>
    <style>
      * {
        font-size: 1.35rem;
      }
      table {
        border-collapse: collapse;
      }
    </style>
  </body>
</html>
